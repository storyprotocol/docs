---
title: Royalty
description: Story 내에서 로열티 지불과 청구를 관리할 수 있습니다.
---

## 로열티

### 메소드

* pay\_royalty\_on\_behalf
* claimable\_revenue
* claim\_all\_revenue
* get\_royalty\_vault\_address

### pay\_royalty\_on\_behalf

함수 호출자가 지불자 IP 자산을 대신하여 수신자 IP 자산에게 로열티를 지불할 수 있습니다.

| 메소드                     |
| ----------------------- |
| `pay_royalty_on_behalf` |

Parameters:

* `receiver_ip_id`: 로열티를 받는 ipId.
* `payer_ip_id`: 로열티를 지불하는 IP 자산의 ID.
* `token`: 로열티 지불에 사용할 토큰.
* `amount`: 지불할 금액.
* `tx_options`: \[선택사항] 트랜잭션 옵션 딕셔너리.

<CodeGroup>
  ```python Python
  from web3 import Web3

  # In this case, lets say there is a root IPA 'A' and a derivative IPA 'B'.
  # Someone wants to pay 'B' for whatever reason (they bought it, they want to tip it, etc).
  # Since the payer is not an IP Asset (rather an external user), the `payer_ip_id` can
  # be a zero address. And the receiver is, well, the receiver's ipId which is B.
  #
  # It's important to note that both 'B' and its parent 'A' will be able
  # to claim revenue from this based on the negotiated license terms
  pay_royalty = story_client.Royalty.pay_royalty_on_behalf(
      receiver_ip_id="0x0b825D9E5FA196e6B563C0a446e8D9885057f9B1",  # B's ipId
      payer_ip_id="0x0000000000000000000000000000000000000000",  # zero address
      token="0x1514000000000000000000000000000000000000",  # $WIP
      amount=Web3.to_wei(2, 'ether'),  # 2 $WIP
      tx_options={"wait_for_transaction": True}
  )
  print(f"Paid royalty at transaction hash {pay_royalty['tx_hash']}")

  # In this case, lets say there is a root IPA 'A' and a derivative IPA 'B'.
  # 'B' earns revenue off-chain, but must pay 'A' based on their negotiated license terms.
  # So 'B' pays 'A' what they are due
  pay_royalty = story_client.Royalty.pay_royalty_on_behalf(
      receiver_ip_id="0x6B86B39F03558A8a4E9252d73F2bDeBfBedf5b68",  # A's ipId
      payer_ip_id="0x0b825D9E5FA196e6B563C0a446e8D9885057f9B1",  # B's ipId
      token="0x1514000000000000000000000000000000000000",  # $WIP
      amount=Web3.to_wei(2, 'ether'),  # 2 $WIP
      tx_options={"wait_for_transaction": True}
  )
  print(f"Paid royalty at transaction hash {pay_royalty['tx_hash']}")
  ```

  ```python Request Parameters
  receiver_ip_id: str  # The ipId that receives the royalties
  payer_ip_id: str  # The ID of the IP asset that pays the royalties
  token: str  # The token to use to pay the royalties
  amount: int  # The amount to pay
  tx_options: dict = None  # Optional: Transaction options
  ```

  ```python Response
  {
    "tx_hash": str,  # The transaction hash
  }
  ```
</CodeGroup>

### claimable\_revenue

로열티 토큰 보유자가 청구할 수 있는 수익 토큰의 총액을 조회합니다.

| 메소드                 |
| ------------------- |
| `claimable_revenue` |

Parameters:

* `royalty_vault_ip_id`: 로열티 볼트의 ID.
* `claimer`: 로열티 토큰 보유자의 주소.
* `token`: 청구할 수익 토큰.

<CodeGroup>
  ```python Python
  claimable = story_client.Royalty.claimable_revenue(
      royalty_vault_ip_id="0x089d75C9b7E441dA3115AF93FF9A855BDdbfe384",
      claimer="0x089d75C9b7E441dA3115AF93FF9A855BDdbfe384",
      token="0x1514000000000000000000000000000000000000"  # $WIP
  )
  print(f"Claimable revenue: {claimable}")
  ```

  ```python Request Parameters
  royalty_vault_ip_id: str  # The id of the royalty vault
  claimer: str  # The address of the royalty token holder
  token: str  # The revenue token to claim
  ```

  ```python Response
  int  # The amount of revenue token claimable
  ```
</CodeGroup>

### claim\_all\_revenue

하위 IP 자산 및/또는 자신의 IP 로열티 볼트에서 모든 수익을 청구합니다.

| 메소드                 |
| ------------------- |
| `claim_all_revenue` |

Parameters:

* `ancestor_ip_id`: 수익이 청구되는 상위 IP의 주소.
* `claimer`: 통화(수익) 토큰의 청구자 주소. 일반적으로 IP가 모든 로열티 토큰을 보유하고 있는 경우 상위 IP의 ipId입니다. 그렇지 않은 경우, 상위 IP 로열티 토큰을 보유하고 있는 주소가 됩니다.
* `child_ip_ids`: 로열티가 발생하는 하위 IP들의 주소.
* `royalty_policies`: 로열티 정책들의 주소로, royalty\_policies\[i]는 child\_ip\_ids\[i]의 로열티 흐름을 관리합니다.
* `currency_tokens`: 로열티가 청구될 통화 토큰들의 주소.
* `claim_options`: \[선택사항]
  * `claim_options['auto_transfer_all_claimed_tokens_from_ip']`: \[선택사항] 활성화된 경우, 지갑이 IP를 소유하고 있다면 청구자의 모든 청구된 토큰이 지갑 주소로 이전됩니다. 지갑이 청구자이거나 청구자가 지갑이 소유한 IP가 아닌 경우에는 토큰이 이전되지 않습니다. False로 설정하면 청구자로부터의 청구된 토큰 자동 이전이 비활성화됩니다.**Default: True**

<CodeGroup>
  ```python Python
  claim_revenue = story_client.Royalty.claim_all_revenue(
      # IP Asset 1's (parent) ipId
      ancestor_ip_id="0x089d75C9b7E441dA3115AF93FF9A855BDdbfe384",
      # whoever owns the royalty tokens associated with IP Royalty Vault 1
      # (most likely the associated ipId, which is IP Asset 1's ipId)
      claimer="0x089d75C9b7E441dA3115AF93FF9A855BDdbfe384",
      currency_tokens=["0x1514000000000000000000000000000000000000"],  # $WIP
      # IP Asset 2's (child) ipId
      child_ip_ids=["0xDa03c4B278AD44f5a669e9b73580F91AeDE0E3B2"],
      # testnet address of RoyaltyPolicyLAP
      royalty_policies=["0xBe54FB168b3c982b7AaE60dB6CF75Bd8447b390E"],
      claim_options={
        'auto_transfer_all_claimed_tokens_from_ip': True
      }
  )

  print(f"Claimed revenue: {claim_revenue['claimed_tokens']}")
  ```

  ```python Request Parameters
  ancestor_ip_id: str  # The address of the ancestor IP
  claimer: str  # The address of the claimer of the currency tokens
  child_ip_ids: list  # The addresses of the child IPs
  royalty_policies: list  # The addresses of the royalty policies
  currency_tokens: list  # The addresses of the currency tokens
  claim_options: dict = None  # Optional: Claim options
  tx_options: dict = None  # Optional: Transaction options
  ```

  ```python Response
  {
    "tx_hashes": list,  # The transaction hashes
    "receipt": dict,  # The transaction receipt
    "claimed_tokens": list  # List of claimed tokens with token address and amount
  }
  ```
</CodeGroup>

### get\_royalty\_vault\_address

주어진 `ip_id`의 로열티 볼트 프록시 주소를 가져옵니다.

| 메소드                         |
| --------------------------- |
| `get_royalty_vault_address` |

Parameters:

* `ip_id`: `ipId`와 연결된 로열티 볼트.

<CodeGroup>
  ```python Python
  vault_address = story_client.Royalty.get_royalty_vault_address("0x089d75C9b7E441dA3115AF93FF9A855BDdbfe384")
  print(f"Royalty vault address: {vault_address}")
  ```

  ```python Request Parameters
  ip_id: str  # The ipId associated with the royalty vault
  ```

  ```python Response
  str  # The royalty vault proxy address
  ```
</CodeGroup>
