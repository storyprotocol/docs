---
title: 수익 청구
description: TypeScript에서 자식 IP 자산의 수익을 청구하는 방법을 알아보세요.
---

<CardGroup cols={1}>
  <Card title="Completed Code" href="https://github.com/storyprotocol/typescript-tutorial/blob/main/scripts/derivative/registerDerivativeCommercial.ts" icon="thumbs-up">
    이 페이지의 모든 내용은 이 작동하는 코드 예제에서 다룹니다.
  </Card>
</CardGroup>

이 섹션에서는 IP 자산의 수익을 청구하는 방법을 보여줍니다.

수익을 청구할 수 있는 두 가지 주요 방법이 있습니다:

1. **시나리오 #1**: 누군가가 내 IP 자산에 직접 지불하고, 나는 그 수익을 청구합니다.
2. **시나리오 #2**: 누군가 내 IP의 파생 IP 자산에 대해 지불하고, 나는 라이선스 조건의 `commercialRevShare` 에 따라 그들의 수익 중 일정 %를 받을 권리가 있습니다.

### 전제 조건

튜토리얼을 시작하기 전에 완료해야 할 몇 가지 단계가 있습니다.

1. 다음을 완료하세요 [TypeScript SDK Setup](/developers/typescript-sdk/setup)
2. 다음에 대한 기본적인 이해가 필요합니다 [Royalty Module](/concepts/royalty-module)
3. 당연히 청구할 지불금이 있어야 합니다. 다음을 읽어보세요 [Pay an IPA](/developers/typescript-sdk/pay-ipa)

## 시작하기 전에

지불이 이루어지면 결국 IP 자산의 [IP Royalty Vault](/concepts/royalty-module/ip-royalty-vault)로 들어갑니다. 여기서 해당 IP 자산의 IP Royalty Vault에 대한 수익 공유 %를 나타내는 Royalty Token을 소유한 사람에게 청구/이전됩니다.

IP Account([IP Asset](/concepts/ip-asset)을 나타내는 스마트 컨트랙트)는 처음 등록될 때 Royalty Token의 100%를 보유합니다. 따라서 일반적으로 대부분의 Royalty Token을 보유하고 있습니다.

<Note>
  **빠른 참고**. 아래의 시나리오와 예시는 [Liquid Absolute Percentage](/concepts/royalty-module/liquid-absolute-percentage) 로열티 정책을 사용합니다. 이는 현재 사용할 수 있는 두 가지 로열티 정책 중 하나입니다.
</Note>

## 시나리오 #1

이 시나리오에서는 내가 IP Asset 3을 소유하고 있습니다. 누군가 내 IP Asset 3에 직접 지불하고, 나는 그 수익을 청구합니다. 단계별로 살펴보겠습니다:

1. 아래 다이어그램에서 볼 수 있듯이, IP Asset 4(IP Asset일 필요는 없으며 어떤 주소든 될 수 있음)가 IP Asset 3에 1M \$WIP를 지불하면, 850k \$WIP가 자동으로 IP Royalty Vault 3에 예치됩니다.

   <Frame>
     <img src="/images/concepts/lap-1.png" alt="Payment flow to IP Royalty Vault" />
   </Frame>

2. 이제 IP Asset 3이 IP Royalty Vault 3에 있는 수익을 청구하고자 합니다. 다음과 같이 진행됩니다:

   <Frame>
     <img src="/images/concepts/lap-3.png" alt="Claiming revenue from IP Royalty Vault" />
   </Frame>

아래는 위 이미지에서 보여진 것처럼 SDK를 사용하여 IP Asset 3이 수익을 청구하는 방법입니다:

<Info>
  관련 문서:
  [royalty.claimAllRevenue](/sdk-reference/royalty#claimallrevenue)
</Info>

```typescript main.ts
import { WIP_TOKEN_ADDRESS } from "@story-protocol/core-sdk";
// you should already have a client set up (prerequisite)
import { client } from "./client";

async function main() {
  const claimRevenue = await client.royalty.claimAllRevenue({
    // IP Asset 3's ipId
    ancestorIpId: "0xDa03c4B278AD44f5a669e9b73580F91AeDE0E3B2",
    // whoever owns the royalty tokens associated with IP Royalty Vault 3
    // (most likely the associated ipId, which is IP Asset 3's ipId)
    claimer: "0xDa03c4B278AD44f5a669e9b73580F91AeDE0E3B2",
    currencyTokens: [WIP_TOKEN_ADDRESS],
    childIpIds: [],
    royaltyPolicies: [],
    claimOptions: {
      // If the wallet claiming the revenue is the owner of the
      // IP Account/IP Asset (in other words, the owner of the
      // IP's underlying NFT), `claimAllRevenue` will transfer all
      // earnings to the user's external wallet holding the NFT
      // instead of the IP Account, for convenience. You can disable it here.
      autoTransferAllClaimedTokensFromIp: true,
      // Unwraps the claimed $WIP to $IP for you
      autoUnwrapIpTokens: true,
    },
  });

  console.log(`Claimed revenue: ${claimRevenue.claimedTokens}`);
}

main();
```

## 시나리오 #2

이 시나리오에서는 내가 IP Asset 1을 소유하고 있습니다. 누군가 파생 IP Asset 3에 지불하고, 나는 라이선스 조건의 `commercialRevShare` 에 따라 그들의 수익 중 일정 %를 받을 권리가 있습니다. 이는 시나리오 #1과 정확히 동일하지만 한 단계가 추가됩니다. 단계별로 살펴보겠습니다:

1. 아래 다이어그램에서 볼 수 있듯이, IP Asset 4(IP Asset일 필요는 없으며 어떤 주소든 될 수 있음)가 IP Asset 3에 1M \$WIP를 지불하면, 150k \$WIP가 자동으로 조상들에게 분배될 LAP 로열티 정책 컨트랙트에 예치됩니다.

   <Frame>
     <img src="/images/concepts/lap-1.png" alt="Revenue distribution to royalty policy contract" />
   </Frame>

2. 그런 다음, 두 번째 단계에서 토큰들은 조상들의 [IP Royalty Vault](/concepts/royalty-module/ip-royalty-vault)로 라이선스 조건에서 협상된 `commercialRevShare`에 따라 이전됩니다.

   <Frame>
     <img src="/images/concepts/lap-2.png" alt="Revenue distribution to ancestors" />
   </Frame>

3. 마지막으로, IP Asset 1과 2는 각자의 IP Royalty Vault에 있는 수익을 청구하고자 합니다. 다음과 같이 진행됩니다:

   <Frame>
     <img src="/images/concepts/lap-3.png" alt="Claiming revenue from ancestor IP Royalty Vaults" />
   </Frame>

아래는 위 이미지에서 보여진 것처럼 SDK를 사용하여 IP Asset 1(또는 2)이 수익을 청구하는 방법입니다:

<Info>
  관련 문서:
  [royalty.claimAllRevenue](/sdk-reference/royalty#claimallrevenue)
</Info>

```typescript main.ts
import { WIP_TOKEN_ADDRESS } from "@story-protocol/core-sdk";
// you should already have a client set up (prerequisite)
import { client } from "./client";

async function main() {
  const claimRevenue = await client.royalty.claimAllRevenue({
    // IP Asset 1's ipId
    ancestorIpId: "0x089d75C9b7E441dA3115AF93FF9A855BDdbfe384",
    // whoever owns the royalty tokens associated with IP Royalty Vault 1
    // (most likely the associated ipId, which is IP Asset 1's ipId)
    claimer: "0x089d75C9b7E441dA3115AF93FF9A855BDdbfe384",
    currencyTokens: [WIP_TOKEN_ADDRESS],
    // IP Asset 3's ipId
    childIpIds: ["0xDa03c4B278AD44f5a669e9b73580F91AeDE0E3B2"],
    // Aeneid testnet address of RoyaltyPolicyLAP
    royaltyPolicies: ["0xBe54FB168b3c982b7AaE60dB6CF75Bd8447b390E"],
    claimOptions: {
      // If the wallet claiming the revenue is the owner of the
      // IP Account/IP Asset (in other words, the owner of the
      // IP's underlying NFT), `claimAllRevenue` will transfer all
      // earnings to the user's external wallet holding the NFT
      // instead of the IP Account, for convenience. You can disable it here.
      autoTransferAllClaimedTokensFromIp: true,
      // Unwraps the claimed $WIP to $IP for you
      autoUnwrapIpTokens: true,
    },
  });

  console.log(`Claimed revenue: ${claimRevenue.claimedTokens}`);
}

main();
```

## 완성된 코드 보기

축하합니다, [Royalty Module](/concepts/royalty-module)을 사용하여 수익을 청구했습니다!

<CardGroup cols={1}>
  <Card title="Completed Code" href="https://github.com/storyprotocol/typescript-tutorial/blob/main/scripts/derivative/registerDerivativeCommercial.ts" icon="thumbs-up">
    이 페이지의 모든 내용은 이 작동하는 코드 예제에서 다루고 있습니다.
  </Card>
</CardGroup>

## Dispute an IP

IP Asset이 자신의 몫을 지불하지 않으면 어떻게 될까요? 다음 페이지에서 다룰 온체인에서 IP를 분쟁 처리할 수 있습니다.
